document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("form.search").forEach(function(f){f.addEventListener("submit",function(e){e.preventDefault()})});var d=document;var grid=d.querySelector(".product-grid");function getCards(){return Array.from(grid.querySelectorAll(".product"))}d.addEventListener("click",function(e){if(e.target.classList.contains("weight-inc")||e.target.classList.contains("weight-dec")){var wrap=e.target.closest('.weight-control');if(!wrap)return;var input=wrap.querySelector('.gram-input');var step=Number(input.step)||100;var min=Number(input.min)||1;var val=parseInt(input.value,10);if(isNaN(val))val=min;if(e.target.classList.contains("weight-inc"))val+=step;else val=Math.max(min,val-step);input.value=val}if(e.target.classList.contains("add-to-cart")){var card=e.target.closest('.product');var name=(card.querySelector('h3')||{}).textContent||"Ürün";name=name.trim();var grams=(card.querySelector('.gram-input')||{}).value||"100";alert(name+" - "+grams+" g sepete eklendi!")}});d.addEventListener("change",function(e){if(e.target.classList.contains("gram-input")){var input=e.target;var min=Number(input.min)||1;var val=parseInt(input.value,10);if(isNaN(val)||val<min)val=min;input.value=val}});function sortProducts(mode){var cards=getCards();cards.sort(function(a,b){var ai=parseInt(a.dataset.index,10)||0;var bi=parseInt(b.dataset.index,10)||0;var ap=parseFloat(a.dataset.price)||0;var bp=parseFloat(b.dataset.price)||0;if(mode==="price-asc")return ap-bp;if(mode==="price-desc")return bp-ap;if(mode==="new")return bi-ai;return ai-bi});cards.forEach(function(c){grid.appendChild(c)})}function getSelected(name){return Array.from(d.querySelectorAll('input[name="'+name+'"]:checked')).map(function(i){return i.value})}function priceOk(price,token){if(!token)return true;if(token==="0-100")return price>=0&&price<100;if(token==="100-200")return price>=100&&price<=200;if(token==="200+")return price>200;return true}function applyFilters(){var types=getSelected("type");var origins=getSelected("origin");var priceToken=(d.querySelector('input[name="price"]:checked')||{}).value||null;getCards().forEach(function(card){var cTypes=(card.dataset.type||'').split(',').map(function(s){return s.trim()}).filter(Boolean);var cOrigin=card.dataset.origin||'';var p=parseFloat(card.dataset.price)||0;var ok=true;if(types.length)ok=types.some(function(t){return cTypes.includes(t)});if(ok&&origins.length)ok=origins.includes(cOrigin);if(ok&&priceToken)ok=priceOk(p,priceToken);card.style.display=ok?"":"none"})}var applyBtn=d.getElementById("applyFilters");var clearBtn=d.getElementById("clearFilters");var sortSelect=d.getElementById("sort");if(applyBtn)applyBtn.addEventListener("click",applyFilters);if(clearBtn)clearBtn.addEventListener("click",function(){d.querySelectorAll('.filter-card input').forEach(function(i){i.checked=false});if(sortSelect)sortSelect.value="popular";getCards().forEach(function(c){c.style.display=""});sortProducts("popular")});if(sortSelect)sortSelect.addEventListener("change",function(){sortProducts(this.value)});sortProducts("popular")});
